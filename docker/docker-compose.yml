version: '3.7'

services:
 userdbserver:
  image: mysql:8.0.12
  #image: mysql:8.0.17
  command: --default-authentication-plugin=mysql_native_password
  container_name: user_dbserver
  volumes:
  - ./mysql8/data:/var/lib/mysql
  - ./sqlinit:/docker-entrypoint-initdb.d/
  ports:
  - "3306:3306"
  environment:
   TZ: Europe/Berlin
   MYSQL_ROOT_PASSWORD: admin 
   MYSQL_DATABASE: userdb
   MYSQL_USER: admin
   MYSQL_PASSWORD: admin
  network_mode: "mynet"
  
 adminer:
  image: adminer
  container_name: adminermysql
  restart: always
  ports:
  - "8383:8080"
  network_mode: "mynet"
  
 userappserver:
  build:
   context: ./
   dockerfile: appserver.dockerfile
  image: userserver:lastest
  container_name: user_appserver
  volumes:
  - ./autodeploy:/opt/payara/appserver/glassfish/domains/production/autodeploy
  ports:
  - "8080:8080"
  - "4848:4848"
  - "9009:9009"
  environment:
   PINGMSG: "Got Ping-Request at: "
  network_mode: "mynet"
